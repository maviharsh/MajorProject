<% layout("/layout/boilerplate.ejs") %>

<h1 class="mt-4 mb-3">ALL LISTINGS</h1>

<div class="row row-cols-lg-3 row-cols-md-2 row-cols-sm-1">
    <% for (let i of allListings) { %>
        <a href="/listings/<%= i._id %>" class="listing-link text-decoration-none text-dark">
            <div class="card listing-card shadow-sm border-0 overflow-hidden">
                <%
                    const thumbnailTransformations = 'w_400,h_300,c_fill,q_auto,f_auto';
                    const optimizedThumbnailUrl = i.image.url.replace('/upload/', `/upload/${thumbnailTransformations}/`);
                    const priceFormatted = i.price.toLocaleString("en-IN");
                %>
                <img 
                    src="<%= optimizedThumbnailUrl %>" 
                    class="card-img-top"
                    alt="<%= i.title %> Image"
                    loading="lazy"
                >
                <div class="card-img-overlay p-0"></div>
                <div class="card-body">
                    <h5 class="card-title"><%= i.title %></h5> 
                    <p class="mb-0">&#x20B9; <%= priceFormatted %> / Night</p>
                </div>
            </div>
        </a>
    <% } %>
</div>
